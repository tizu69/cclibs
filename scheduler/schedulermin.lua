local a=require"cc.expect"local b,c=a.expect,a.range;local d={["<"]=1,["="]=2,[">"]=0}local e={["="]=0,[">"]=1}local f={t=0,s=1,m=2}local g={daily=0,["12h"]=1,["6h"]=2,["4h"]=3,["3h"]=4,["2h"]=5,hourly=6,["45m"]=7,["30m"]=8,["15m"]=9}local h={}h.any="minecraft:air"function h.new(i)b(1,i,"boolean","table")local j=type(i)=="boolean"and{cyclic=i,entries={}}or i;local k,l=0,0;if j.ctx then k,l=j.ctx.station,j.ctx.condition end;local m=setmetatable({ctx={station=k,condition=l}},{__index=h})j=setmetatable(j,{__index=m})return j end;function h:entry(n,i)b(1,n,"string")b(2,i,"table")self.ctx.station=self.ctx.station+1;self.ctx.condition=1;self.entries[self.ctx.station]={instruction={id=n,data=i},conditions={}}return self end;function h:condition(n,i)b(1,n,"string")b(2,i,"table")local o=self.entries[self.ctx.station].conditions;o[self.ctx.condition]=o[self.ctx.condition]or{}table.insert(o[self.ctx.condition],{id=n,data=i})return self end;function h:OR()self.ctx.condition=self.ctx.condition+1;return self end;function h:serialize(p)self.ctx=nil;return p and textutils.serializeJSON(self)or textutils.serialize(self)end;function h:to(q)b(1,q,"string")return self:entry("create:destination",{text=q})end;function h:rename(q)b(1,q,"string")return self:entry("create:rename",{text=q})end;function h:section(r,s,t,u)b(1,r,"string")b(2,s,"string")b(3,t,"boolean")b(4,u,"boolean")return self:entry("createrailwaysnavigator:travel_section",{train_group=r,train_line=s,include_previous_station=t,usable=u})end;function h:throttle(v)b(1,v,"number")c(v,5,100)return self:entry("create:throttle",{value=v})end;function h:through(q)b(1,q,"string")return self:entry("railways:waypoint_destination",{text=q})end;function h:setlink(w,x,y)b(1,w,"string")b(2,x,"string")b(3,y,"number")return self:entry("railways:redstone_link",{frequency={{id=w,count=1},{id=x,count=1}},power=y})end;function h:fixtimings()return self:entry("createrailwaysnavigator:reset_timings",{})end;function h:wait(z,A)b(1,z,"number")b(2,A,"string","nil")A=A or"s"return self:condition("create:delay",{value=z,time_unit=f[A]})end;function h:time(B,C,D)b(1,B,"number")b(2,C,"number")b(3,D,"string")c(B,0,23)c(C,0,59)return self:condition("create:time_of_day",{hour=B,minute=C,rotation=g[D]})end;function h:fluid(E,F,G)b(1,E,"string")b(2,F,"string")b(3,G,"number")return self:condition("create:fluid_threshold",{bucket={id=E,count=1},threshold=tostring(G),operator=d[F],measure=0})end;function h:item(E,F,G)b(1,E,"string")b(2,F,"string")b(3,G,"number")return self:condition("create:item_threshold",{bucket={id=E,count=1},threshold=tostring(G),operator=d[F],measure=0})end;function h:getlink(w,x,H)b(1,w,"string")b(2,x,"string")b(3,H,"boolean")return self:condition("create:redstone_link",{frequency={{id=w,count=1},{id=x,count=1}},inverted=H and 0 or 1})end;function h:passengers(F,I)b(1,F,"string")b(2,I,"number")return self:condition("create:player_count",{count=I,exact=e[F]})end;function h:cargoidle(z,A)b(1,z,"number")b(2,A,"string","nil")A=A or"s"return self:condition("create:idle",{value=z,time_unit=f[A]})end;function h:unloaded()return self:condition("create:unloaded",{})end;function h:powered()return self:condition("create:powered",{})end;function h:loaded()return self:condition("railways:loaded",{})end;function h:waitdynamic(z,J,A)b(1,z,"number")b(2,J,"number")b(3,A,"string","nil")A=A or"s"return self:condition("createrailwaysnavigator:dynamic_delay",{value=z,min=J,time_unit=f[A]})end;function h:energy(F,G)b(1,F,"string")b(2,G,"number")return self:condition("createaddition:energy_threshold",{threshold=G,operator=d[F],measure=0})end;return h
